<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cough.web.board.mapper.BoardMapper">
	<select id="searchAll" resultType="BoardVO">
		select * from board
		order by
		regdate desc
	</select>

	<select id="search" resultType="BoardVO">
		select * from board
		where
		bno=#{bno}
	</select>

	<insert id="insert" parameterType="BoardVO">
		<!-- 게시글번호자동생성하는거 -->
		<selectKey keyProperty="bno" resultType="int" order="BEFORE">
			select
			nvl(max(bno),0)+1 from board
		</selectKey>
		insert into board
		(title
		<if test="regdate!=null">
			,regdate
		</if>
		<if test="contents!=null !contents.equals('')">
			,contents
		</if>
		<if test="image!=null and !image.equals('')">
			,image
		</if>
		,writer
		<!-- ,sysdate regdate DB의 default가 sysdate라서 따로 지정할 필요 없으 -->
		)
		values
		(#{title}
		<if test="regdate!=null">
			#{regdate}
		</if>
		<if test="contents!=null !contents.equals('')">
			,#{contents}
		</if>
		<if test="image!=null">
			,#{image}
		</if>
		,#{writer}
		<!-- sysdate -->
		<!-- regdate DB의 default가 sysdate라서 따로 지정할 필요 없음 -->
		)
	</insert>
	<update id="update" parameterType="BoardVO">
		update board
		<set>
			<if test="title!=null and !title.equals('')">
				title=#{title},
			</if>
			<if test="contents!=null and !contents.equals('')">
				contents=#{contents},
			</if>
			<if test="image!=null and !image.equals('')">
				image=#{image},
			</if>
			<choose>
				<when test="updatedate!=null and !updatedate.equals('')">
					updatedate=#{updatedate}
				</when>
				<when test="updatedate==null or updatedate.equals('')">
					updatedate=sysdate
				</when>
			</choose>
		</set>
		where bno=#{bno}
	</update>

</mapper>